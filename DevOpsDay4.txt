Configuration Management

Desired State = something you declare

Actual State = what is there

Should have 

Desired State = Actual State

Create EC2
1. Create with Terraform
2. Set up Ansible with Terraform
3. Configure with Ansible Playbooks
4. Install Docker

Ansible works on controller or master slave model
1. Dictates desired state
2. Push desired state on managed nodes -> Windows and Linux

One machine -> Controller or Ansible Master -> ansible-controller
	1. Install Ansible
	2. inventory file has machines by Ip addresses or Domain names
	3. /etc/ansible.cfg - runs whenever ansible runs
	4. private_key_file = ~/.ssh/ansible 
	5. Linux = SSH -> port 22
	6. Windows = SSH OR WinRM -> port 5986
	7. Push based mechanism like saltstack (but saltstack is not as developed as ansible)
	8. Desired state is declared in a playbook

COMMANDS on the server - not playbook
ansible all -m ping -> outputs ping message

ansible all --list-hosts -> lists IPs of servers

ansible all -m setup

ansible all -m user -a "state=present name=sbean" --become --become-user root

cat /etc/passwd

ansible all -m gather_facts -> outputs a ton of info about the servers

ansible all -m gather_facts --limit 172.16.250.132

With no nodes ansible localhost -m ping

   20  cat /etc/passwd| grep -i kmayer
   21  ansible all -m user -a "state=present name=kmayer" --become --become-user root
   21  ansible all -m user -a "state=present name=kmayer" --become --become-user root
   22  sudo deluser kmayer
   23  ansible all -m user -a "state=present name=kmayer" --become --become-user root
   24  cat /etc/passwd| grep -i kmayer
   25  ansible all -m user -a "state=present name=kmayer shell=/bin/bash" --become --become-user root
   26  cat /etc/passwd| grep -i kmayer
   27  ansible all -m user -a "state=present name=kmayer shell=/bin/bash" generate_ssh_key=true create_home=true --become --become-user root
	
ansible all -m package -a "name=nodejs, name=npm, name=postgresql-client state=present" --become --become-user root

ansible all -m file -a "path=/tmp/data state=directory recurse=true" --become --become-user root

to add user and owner:
ansible all -m file -a "path=/tmp/data mode="755" owner="kmayer" state=directory group="kmayer"" --become